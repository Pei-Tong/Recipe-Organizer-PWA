let e,t,r;function i(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var n=globalThis,o={},a={},c=n.parcelRequire94c2;null==c&&((c=function(e){if(e in o)return o[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return o[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},n.parcelRequire94c2=c);var l=c.register;l("27Lyk",function(e,t){i(e.exports,"register",()=>r,e=>r=e),i(e.exports,"resolve",()=>n,e=>n=e);var r,n,o=new Map;r=function(e,t){for(var r=0;r<t.length-1;r+=2)o.set(t[r],{baseUrl:e,path:t[r+1]})},n=function(e){var t=o.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),l("jOsMR",function(e,t){var r=c("Gr8vk");e.exports=r("k5KBG").then(()=>c("lR3v8"))}),l("Gr8vk",function(e,t){e.exports=function(e){return import(c("27Lyk").resolve(e))}}),l("ceyET",function(e,t){e.exports=new URL("service-worker.8d5d443b.js",import.meta.url).toString()}),c("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["isBQ7","index_0.f3535a86.js","k5KBG","loglevel.2daa5c96.js","ivUfc","service-worker.8d5d443b.js","nZBkt","index.95099fc4.js","8CGZa","index_0.22e893d8.js"]'));var s=c("fhN3L"),d=c("ilpIi"),p=c("j3my9");const u=document.getElementById("recipeName"),f=document.getElementById("ingredients"),m=document.getElementById("steps"),g=document.getElementById("mealType"),v=document.getElementById("addRecipeBtn"),h=document.getElementById("recipeList"),y=document.getElementById("filterIngredient"),w=document.getElementById("filterMealType"),E=document.getElementById("clearFilterBtn"),R=document.getElementById("send-btn"),I=document.getElementById("chat-input"),k=document.getElementById("chat-history"),b=document.getElementById("qr-btn");try{c("jOsMR").then(t=>{(e=t.default).setLevel("info"),e.info("Application started")}).catch(t=>{console.error("Failed to load loglevel:",t),e=console,console.info("Application started (using console as fallback)")})}catch(t){console.error("Error initializing loglevel:",t),e=console}const L=(0,s.initializeApp)({apiKey:"AIzaSyB7UqECLIMhMXofB0ZsmB-cqSrbRxk53VI",authDomain:"recipe-organizer-pwa.firebaseapp.com",projectId:"recipe-organizer-pwa",storageBucket:"recipe-organizer-pwa.firebasestorage.app",messagingSenderId:"523889521938",appId:"1:523889521938:web:3ff88954b9ba279af22fcb"}),B=(0,d.getFirestore)(L);async function F(){try{t=(await (0,d.getDoc)((0,d.doc)(B,"apikey","googlegenai"))).data().key,r=new p.GoogleGenerativeAI(t).getGenerativeModel({model:"gemini-1.5-flash"})}catch(t){throw e.error("Error fetching API key from Firestore: ",t),t}}async function A(t){if(!r)throw Error("Generative AI model not initialized. Please wait for page load.");try{return(await r.generateContent(`Provide a recipe suggestion or answer for: ${t}. If it's a recipe query, include name, ingredients, and steps.`)).response.text()}catch(t){throw e.error("Error in askChatBot:",t),t}}document.addEventListener("DOMContentLoaded",async()=>{await F(),e.info("API Key and Generative AI initialized.")});const x=new URL(c("ceyET"));function C(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}async function $(t){console.log("Adding recipe to Firestore:",t);try{let r=await (0,d.addDoc)((0,d.collection)(B,"recipes"),t);return e.info(`Recipe added successfully with ID: ${r.id}`),D(),r}catch(t){throw e.error("Error adding recipe to Firestore: ",t),t}}async function P(t){console.log("Attempting to delete recipe with ID:",t);let r=(0,d.doc)(B,"recipes",t);try{await (0,d.deleteDoc)(r),e.info(`Recipe with id ${t} has been deleted from Firestore.`),T(t)}catch(t){e.error("Error removing recipe: ",t),alert("Failed to delete recipe. Please check the recipe ID or try again.")}}function T(t){let r=document.getElementById(t);r?(r.remove(),e.info(`Recipe with id ${t} removed from the visual interface.`)):e.warn(`Recipe with id ${t} not found on the page.`)}function _(){let t=y.value.trim().toLowerCase(),r=w.value.toLowerCase();(0,d.getDocs)((0,d.collection)(B,"recipes")).then(e=>{h.innerHTML="",e.forEach(e=>{let i=e.data(),n=!t||i.ingredients.some(e=>e.toLowerCase().includes(t)),o=!r||i.mealType.toLowerCase()===r;n&&o&&H(e.id,i)})}).catch(t=>{e.error("Error filtering recipes:",t),alert("Failed to filter recipes. Please try again.")})}async function D(){let e=await S();h.innerHTML="",e.forEach(e=>{H(e.id,e.data())})}function H(e,t){let r=document.createElement("li");r.id=e,r.tabIndex=0,r.innerHTML=`
    <span>${t.name} (${t.mealType})</span>
    <span class="actions">
      <button onclick="editRecipe('${e}', { name: prompt('New name:', '${t.name}'), mealType: prompt('New meal type:', '${t.mealType}') })">Edit</button>
      <button onclick="removeRecipe('${e}')">Delete</button>
      <button onclick="toggleFavorite('${e}', ${t.favorite||!1})">${t.favorite?"Unfavorite":"Favorite"}</button>
    </span>
  `,h.appendChild(r)}async function S(){let e=await (0,d.getDocs)((0,d.collection)(B,"recipes")),t=[];return e.forEach(e=>{t.push(e)}),t}function j(e){let t=document.createElement("div");t.textContent=e,t.className="history",k.appendChild(t),I.value=""}"serviceWorker"in navigator&&navigator.serviceWorker.register(x.href,{scope:"/Recipe-Organizer-PWA/"}).then(()=>e.info("Service Worker Registered for scope:",x.href,"with","file:///assets/js/script.js")).catch(t=>e.error("Service Worker Error:",t)),v.addEventListener("click",async()=>{let t=u.value.trim(),r=f.value.trim(),i=m.value.trim(),n=g.value;if(t&&r&&i&&n){let o={name:C(t),ingredients:C(r).split(",").map(e=>e.trim()),steps:C(i).split("\n").map(e=>e.trim()).filter(e=>e),mealType:n,favorite:!1};try{console.log("Attempting to add recipe:",o),await $(o),D(),u.value="",f.value="",m.value="",g.selectedIndex=0,alert("Recipe added successfully!"),e.info(`Recipe "${t}" added successfully.`)}catch(t){e.error("Error adding recipe:",t),alert("Failed to add recipe. Please try again.")}}else alert("Please fill in all recipe fields.")}),u.addEventListener("keypress",function(e){"Enter"===e.key&&v.click()}),E.addEventListener("click",()=>{y.value="",w.value="",D()}),y.addEventListener("input",_),w.addEventListener("change",_),window.editRecipe=function(t,r){let i=(0,d.doc)(B,"recipes",t);(0,d.updateDoc)(i,r).then(()=>{e.info(`Recipe with id ${t} updated successfully.`),D()}).catch(t=>{e.error("Error updating recipe:",t),alert("Failed to update recipe. Please try again.")})},window.removeRecipe=P,window.toggleFavorite=function(t,r){let i=(0,d.doc)(B,"recipes",t);(0,d.updateDoc)(i,{favorite:!r}).then(()=>{e.info(`Favorite status toggled for recipe with id ${t}.`),D()}).catch(t=>{e.error("Error toggling favorite:",t),alert("Failed to toggle favorite status. Please try again.")})},R.addEventListener("click",async()=>{let t=I.value.trim().toLowerCase();if(t)try{if(!function(e){if(e.startsWith("add recipe")){let t=e.replace("add recipe","").trim();if(t){let e={name:t,ingredients:[],steps:[],mealType:"Dinner",favorite:!1};console.log("Attempting to add recipe via chatbot:",e),$(e),j(`Recipe ${t} added!`),D()}else j("Please specify a recipe name to add.");return!0}if(e.startsWith("complete")){let t=e.replace("complete","").trim();return t?function(e){let t=h.getElementsByTagName("li"),r=!1;for(let i of t)i.querySelector("span:first-child").textContent.trim().split(" (")[0].toLowerCase()===e.toLowerCase()&&(P(i.id),T(i.id),r=!0);return r}(t)?(j(`Recipe ${t} marked as complete.`),D()):j("Recipe not found!"):j("Please specify a recipe to complete."),!0}if(e.startsWith("find recipes with")){var t;let r=e.replace("find recipes with","").trim();return r?(t=r,y.value=t,_(),j(`Finding recipes with ${r}...`)):j("Please specify an ingredient."),!0}return!1}(t)){let e=await A(t);j(e)}}catch(t){e.error("Error processing AI request:",t),j("Error: Could not process your request.")}else j("Please enter a prompt")}),b.addEventListener("click",()=>{window.open(`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent("https://pei-tong.github.io/Recipe-Organizer-PWA/")}`,"_blank")||alert("Please allow popups to generate QR code.")});
//# sourceMappingURL=index_0.f3535a86.js.map
